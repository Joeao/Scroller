(function(d,b,f){var c="cScroll";var e={initiate:function(){},start:function(){},stop:function(){},step:function(){},throttle:false,throttleLimit:20,drawCursor:false,showDebugging:false,triggerOnChild:false,duration:250,startEvents:"mousedown",stopEvents:"mouseup"};function a(h,g){this.name=c;this.el=h;this.$el=d(h);this.defaults=e;this.options=d.extend({},this.defaults,g);this.$window=d(b);this.$document=d(this.$el[0].ownerDocument);this.$body=this.$document.find("body");if(d.throttle==f){this.options.throttle=false}this.moveTrigger="mousemove";this.startTrigger=this.options.startEvents;this.stopTrigger=this.options.stopEvents;this.started=false;this.init()}a.prototype.init=function(){var g=this;g.$el.bind(g.startTrigger,function(h){if(!g.options.triggerOnChild){if(d(h.target).is(g.$el)){g.handleStart(h)}}else{g.handleStart(h)}});g.$document.bind(g.stopTrigger,function(h){g.handleStop(h)});if(g.options.showDebugging){g.$body.append('<p id="scroller-debugging" style="position:fixed; bottom:10px; right:10px; font-size:22px; z-index:9999;"></p>')}};a.prototype.handleStart=function(i){var g=this;g.started=true;var h={x:i.clientX,y:i.clientY};g.options.start(i);g.$el.one(g.moveTrigger,function(j){if(g.options.drawCursor){d("*").css("cursor","none");d("body").append("<div id='cScroll-cursor-box' style='position:fixed; z-index:9999999; '></div>");d("#cScroll-cursor-box").append("<p id='cScroll-pointer' style='position:relative; font-size:44px; font-family: Arial, Helvetica, sans-serif; left:"+(j.clientX-22)+"px; top:"+(j.clientY-22)+"px;'>V</p>")}g.options.initiate(j)});if(g.options.thottle){g.$el.bind(g.moveTrigger,d.throttle(g.options.throttleLimit,true,function(j){g.handleMove(h,j)}))}else{g.handleMove(h,ev)}};a.prototype.handleMove=function(j,k){if(this.started){var i=this;var g={x:k.clientX,y:k.clientY};var h=i.calculatePosition(j,g);i.animate(h);if(i.options.drawCursor){i.drawCursor(j,g)}}};a.prototype.handleStop=function(h){if(this.started){var g=this;g.options.stop(h);g.started=false;g.stopAnimate();g.$el.unbind(this.moveTrigger);if(g.options.showDebugging){g.$body.find("#scroller-debugging").text("")}d("body #cScroll-cursor-box").remove();d("*").css("cursor","")}};a.prototype.calculatePosition=function(l,i){var s=this;var h={x:s.$window.width(),y:s.$window.height()};var r={x:-this.$el[0].offsetLeft,y:-this.$el[0].offsetTop};var g={x:r.x+l.x,y:r.y+l.y};var p={x:r.x+i.x,y:r.y+i.y};var k={x:p.x-g.x,y:p.y-g.y};var q={x:s.$el[0].clientWidth,y:s.$el[0].clientHeight};var j;if(k.x>=0&&k.y>=0){j=Math.min(((q.x-h.x-r.x)/k.x),((q.y-h.y-r.y)/k.y))}else{if(k.x>=0&&k.y<=0){j=Math.min(((q.x-h.x-r.x)/k.x),(-r.y/k.y))}else{if(k.x<=0&&k.y>=0){j=Math.min((-r.x/k.x),((q.y-h.y-r.y)/k.y))}else{if(k.x<=0&&k.y<=0){j=Math.min((-r.x/k.x),(-r.y/k.y))}}}}var o={x:Math.round(r.x+(j*k.x)),y:Math.round(r.y+(j*k.y)),n:j};return o};a.prototype.calculateAngle=function(i,g){var h=Math.atan2(g.x-i.x,g.y-i.y)*180/Math.PI+360;return h};a.prototype.animate=function(h){var g=this;this.$el.stop(true,false).animate({left:-h.x,top:-h.y},{step:function(){g.options.step();if(g.options.showDebugging){g.$body.find("#scroller-debugging").text("Left:"+-g.$el[0].offsetLeft+"; Top:"+-g.$el[0].offsetTop+"; N:"+(h.n).toFixed(4))}},duration:h.n*g.options.duration,easing:"linear"})};a.prototype.stopAnimate=function(){this.$el.stop()};a.prototype.drawCursor=function(j,g){var h=this;var l=h.calculateAngle(j,g);var i="rotate(-"+l+"deg)";var k="translateX("+(g.x-j.x)+"px) translateY("+(g.y-j.y)+"px)";d("body #cScroll-cursor-box").css({"-webkit-transform":k,"-ms-transform":k,transform:k});d("body #cScroll-pointer").css({"-webkit-transform":i,"-ms-transform":i,transform:i})};d.fn[c]=function(g){return this.each(function(){if(!d.data(this,"plugin_"+c)){var h=new a(this,g);d.data(this,"plugin_"+c,h)}})};d.cScroll={}}(jQuery,window));